# Naming Conventions

## Critical: Lambda Function Name

**IMPORTANT**: The Lambda function name is **ALWAYS** `secrets-replicator` (no environment suffix).

This is a **deliberate design decision** and must NOT be changed to include environment suffixes like `-dev`, `-qa`, or `-prod`.

### Why?

- Consistent function name across all environments
- Simplifies IAM policies and references
- Reduces configuration complexity
- Stack name provides environment differentiation

### Correct Configuration

```yaml
# template.yaml
FunctionName: secrets-replicator  # ✅ CORRECT - No environment suffix
```

### Stack Names (with environment suffix)

While the **function name** stays constant, the **CloudFormation stack name** varies by environment:

- **Dev**: `secrets-replicator-dev`
- **QA**: `secrets-replicator-qa`
- **Prod**: `secrets-replicator-prod`

### IAM Policy Implications

Because the function name is `secrets-replicator` (without environment suffix), IAM policies must allow:

```json
{
  "Resource": [
    "arn:aws:lambda:*:737549531315:function:secrets-replicator"
  ]
}
```

**NOT**:
```json
{
  "Resource": [
    "arn:aws:lambda:*:737549531315:function:secrets-replicator-dev-*",
    "arn:aws:lambda:*:737549531315:function:secrets-replicator-qa-*",
    "arn:aws:lambda:*:737549531315:function:secrets-replicator-prod-*"
  ]
}
```

## Other Resource Naming

Other resources (IAM roles, EventBridge rules, SQS queues, SNS topics, etc.) **DO** include environment-specific naming through the stack name or explicit suffixes:

- IAM Role: `secrets-replicator-dev-SecretReplicatorFunctionRole-*` (generated by CloudFormation)
- EventBridge Rule: `secrets-replicator-dev-SecretUpdateEvent` (via `!Sub` in template)
- SQS Queue: `secrets-replicator-dev-dlq` (via `!Sub` in template)
- SNS Topic: `secrets-replicator-dev-alerts` (via `!Sub` in template)

## Summary

| Resource | Pattern | Example Dev | Example Prod |
|----------|---------|-------------|--------------|
| **Lambda Function** | `secrets-replicator` | `secrets-replicator` | `secrets-replicator` |
| CloudFormation Stack | `secrets-replicator-{env}` | `secrets-replicator-dev` | `secrets-replicator-prod` |
| IAM Role | `{stack}-SecretReplicatorFunctionRole-*` | `secrets-replicator-dev-SecretReplicatorFunctionRole-ABC123` | `secrets-replicator-prod-SecretReplicatorFunctionRole-XYZ789` |
| EventBridge Rule | `{stack}-SecretUpdateEvent` | `secrets-replicator-dev-SecretUpdateEvent` | `secrets-replicator-prod-SecretUpdateEvent` |
| SQS DLQ | `{stack}-dlq` | `secrets-replicator-dev-dlq` | `secrets-replicator-prod-dlq` |
| SNS Topic | `{stack}-alerts` | `secrets-replicator-dev-alerts` | `secrets-replicator-prod-alerts` |

## DO NOT

- ❌ DO NOT add environment suffixes to the Lambda function name
- ❌ DO NOT use patterns like `secrets-replicator-{env}` for the function
- ❌ DO NOT create IAM policies that expect environment-specific function names

## DO

- ✅ DO keep the Lambda function name as `secrets-replicator`
- ✅ DO use the stack name to differentiate environments
- ✅ DO use `!Sub` with `${AWS::StackName}` for other resources that need environment-specific names
